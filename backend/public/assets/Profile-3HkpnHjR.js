import{N as d,O as j,b as R,c as I,a4 as E,K as v,a5 as $,d as k,j as e,E as F,B as x,u as L,a as B,a6 as O,a7 as q,a8 as K,v as N,o as Q,X as P,t as y,U as M,a9 as D,aa as T,ab as V}from"./index-DVVaJp0R.js";import{d as X}from"./index-BCqmEMr2.js";import{v as b}from"./validators-DuhDfRqZ.js";import{u as Y}from"./useProfile-gNo5Grlv.js";import"./isValidEmail-D0JiuvvC.js";const z="_form_1ifdc_1",A="_formRow_1ifdc_9",m={form:z,formRow:A};function G(){const n=d(j),a=R(),{mutate:s,isPending:r}=I({mutationFn:o=>E(o),onSuccess:()=>{v.success("Profile updated successfully"),a.invalidateQueries({queryKey:[`user:${n}`]})},onError:o=>{v.error(o.message)}});return{updateProfile:s,isUpdating:r}}function H({close:n}){const a=d($),{updateProfile:s,isUpdating:r}=G(),{register:o,handleSubmit:l,formState:p,reset:h}=k({defaultValues:{email:a.email,username:a.username,bio:a.bio||"",profilePic:a.profilePic}}),{errors:i}=p,u=f=>{s(f,{onSuccess:n})};return e.jsxs("div",{children:[e.jsx("div",{className:m.profilePic,children:e.jsx("img",{})}),e.jsxs("form",{className:m.form,onSubmit:l(u),encType:"multipart/form-data",children:[e.jsxs("div",{className:m.formRow,children:[e.jsx("label",{htmlFor:"username",children:"Username:"}),e.jsx("input",{className:"inp",id:"username",...o("username",b.username)}),(i==null?void 0:i.username)&&e.jsx(F,{message:i.username.message})]}),e.jsxs("div",{className:m.formRow,children:[e.jsx("label",{htmlFor:"email",children:"Email:"}),e.jsx("input",{className:"inp",...o("email",b.email)}),(i==null?void 0:i.email)&&e.jsx(F,{message:i.email.message})]}),e.jsxs("div",{className:m.formRow,children:[e.jsx("label",{children:"Bio"}),e.jsx("textarea",{className:"textarea",...o("bio")})]}),e.jsxs("div",{className:m.formRow,children:[e.jsx("label",{children:"Profile Pic"}),e.jsx("input",{className:"",type:"file",...o("profilePic")})]}),e.jsx(x,{type:"primary",disable:r,children:"Save"})]})]})}const J="_profile__container_vf899_1",W="_box_vf899_5",Z="_profile_vf899_1",ee="_avatar_vf899_31",se="_btn__container_vf899_51",oe="_profile__stats_vf899_67",c={profile__container:J,box:W,profile:Z,avatar:ee,btn__container:se,profile__stats:oe};function me(){var w;const n=L(),a=B(),{profile:s,isProfileLoading:r,error:o}=Y(),{follow:l,isFollowing:p}=O(),{unFollow:h,isUnFollowing:i}=q(),u=d(j),f=d(K),S=((w=s==null?void 0:s.posts)==null?void 0:w.length)||0,[U,_]=N.useState(!1),C=t=>t===u?e.jsxs(e.Fragment,{children:[e.jsxs(x,{type:"primary",variation:"rounded",width:"normal",onClick:()=>_(!0),children:[e.jsx(D,{})," Edit"]}),U&&e.jsx(P,{onClose:()=>_(!1),children:e.jsx(H,{close:()=>_(!1)})})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{type:"secondary",variation:"rounded",width:"normal",onClick:()=>n(`/messages/${t}`),children:u===s._id?e.jsxs(e.Fragment,{children:[e.jsx(X,{})," Message"]}):"Message"}),e.jsx(x,{type:"primary",variation:"rounded",width:"normal",disabled:p||i,onClick:()=>f.includes(t)?h(t,a(T(t))):l(t,a(V(t))),children:f.includes(t)?"Unfollow":"Follow"})]});return r?e.jsx(Q,{}):o?e.jsx("h3",{children:o.message}):e.jsx("section",{className:c.profile,children:e.jsxs("div",{className:c.profile__container,children:[e.jsxs("figure",{className:c.box+" flex col a-center ",children:[e.jsx("img",{className:c.avatar,src:s.profilePic||"https://randomuser.me/api/portraits/men/99.jpg",alt:""}),e.jsxs("figcaption",{children:[e.jsx("h3",{children:s.username}),e.jsx("p",{children:s.bio})]})]}),e.jsx("div",{className:c.btn__container+" flex j-center",children:C(s._id)}),e.jsxs("div",{className:c.profile__stats+" flex j-center",children:[e.jsx(ae,{profile:s}),e.jsx(ne,{profile:s}),e.jsx(g,{value:S,name:"Posts"})]}),e.jsx("div",{className:"flex col"})]})})}function g({value:n,name:a,modalComponent:s}){const[r,o]=N.useState(!1);return e.jsxs("div",{className:c.box,onClickCapture:()=>o(!0),children:[e.jsx("h3",{children:n}),e.jsx("span",{children:a}),r&&e.jsx(P,{onClose:()=>o(!1),children:s})]})}function ae({profile:n}){const a=n.followers,s=a.length,o=d(j)===n._id?"No one follows you":`No one follows ${n.username}`;return e.jsx(g,{value:s,name:"Followers",modalComponent:e.jsx(y,{items:a||[],render:l=>e.jsx(M,{user:{...l,_id:l.followerId}},l._id),title:"Followers",failureMessage:o})})}function ne({profile:n}){const a=n.following,s=a.length,o=d(j)===n._id?"You are not following anyone":`${n.username} is not following anyone`;return e.jsx(g,{value:s,name:"Following",modalComponent:e.jsx(y,{items:a||[],render:l=>e.jsx(M,{user:{...l,_id:l.followingId}},l._id),title:"Followers",failureMessage:o})})}export{me as default};
