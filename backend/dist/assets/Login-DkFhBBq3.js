import{a as h,b as x,c as j,l as u,_,j as s,d as b,E as d,L as g,B as w,e as f,s as v,r as N}from"./index-7HsAbwMd.js";import{i as p}from"./isValidEmail-D0JiuvvC.js";import{u as y}from"./useBack-Eb6m5MLo.js";import{l as k}from"./authApi-Nl2e0STE.js";const B="_login__container_132ux_13",P="_img__container_132ux_29",L="_post__bg_132ux_43",C="_login__heading_132ux_61",S="_login__text_132ux_73",E="_login__form_132ux_85",q="_link_132ux_95",D="_loginButton_132ux_105",e={"btn--back":"_btn--back_132ux_1",login__container:B,img__container:P,post__bg:L,login__heading:C,login__text:S,login__form:E,link:q,loginButton:D};function $(){const i=h(),a=x(),{mutate:o,isPending:r}=j({mutationFn:n=>k(n),onSuccess:n=>{i(u(n)),_.success("Welcome Back"),a.invalidateQueries({queryKey:[`user:${n._id}`]})},onError:n=>{_.error(n.message)}});return{login:o,isLoggingIn:r}}const F="_authButton_99tzt_1",I={authButton:F};function m({text:i,icon:a}){return s.jsxs("button",{className:I.authButton,children:[s.jsx("img",{src:a}),i]})}const T={email:"drag@email.com",password:"12345678"};function z(){const{login:i,isLoggingIn:a}=$(),{register:o,handleSubmit:r,formState:n}=b(),{errors:t}=n,l=y();return s.jsx("section",{className:"login",children:s.jsx("div",{className:"container",children:s.jsxs("div",{children:[s.jsxs("button",{className:"btn btn__primary btn--square "+e["btn--back"],onClick:l,children:[" ",s.jsx("img",{src:"/images/icons/back.png"})]}),s.jsxs("div",{className:e.login__container,children:[s.jsxs("div",{className:e.img__container,children:[s.jsx("img",{src:"images/post-portrait.png",alt:"phone"}),s.jsx("img",{src:"images/post-portrait-2.png",alt:"phone",className:e.post__bg})]}),s.jsxs("div",{children:[s.jsx("h1",{className:e.login__heading,children:"Hello Again!"}),s.jsx("p",{className:e.login__text,children:"Sign in to your account"}),s.jsxs("form",{method:"POST",className:"login__form",onSubmit:r(i),children:[s.jsxs("div",{children:[s.jsx("input",{type:"email",className:"inp inp__secondary",placeholder:"Enter your email",...o("email",{required:"This field is required",validate:c=>p(c)||"Please provide a valid email"})}),(t==null?void 0:t.email)&&s.jsx(d,{message:t.email.message})]}),s.jsxs("div",{className:e.passwordInput,children:[s.jsx("input",{type:"password",className:"relative inp inp__secondary",placeholder:"Enter your password",...o("password",{required:"Please provide this field",minLength:{value:8,message:"Password must be 8 characters long"},maxLength:{value:20,message:"Password should not be larger than 20 characters"}})}),(t==null?void 0:t.password)&&s.jsx(d,{message:t.password.message})]}),s.jsx(g,{className:e.link,to:"/forgotPassword",children:"Forgot password ?"})," ",s.jsx("br",{}),s.jsx(g,{className:e.link,onClick:()=>i(T),children:"continue with test credentials"}),s.jsx(w,{type:"primary",disabled:a,children:"Log in"})]}),s.jsxs("div",{children:[s.jsx("span",{className:e.line,children:"---------------"}),s.jsx("span",{children:"or with"}),s.jsx("span",{className:e.line,children:"---------------"}),s.jsx(m,{text:"Continue with google",icon:"/images/icons/google.png"}),s.jsx(m,{text:"Continue with twitter",icon:"/images/icons/twitter.png"}),s.jsxs("p",{className:e.login__text,children:["Dont have an account?"," ",s.jsx(g,{className:e.link,to:"/signup",children:"Sign up"})]})]})]})]})]})})})}async function H({request:i}){const a=await i.formData(),o=a.get("email"),r=a.get("password"),n={};if(p(o)||(n.email="Please provide a valid email"),r.length<8&&(n.password="Password must be 8 chracter long"),n.email||n.password)return n;const t={method:"POST",url:"http://localhost:3000/api/users/login",withCredentials:!0,data:{email:o,password:r}};try{const c=(await f(t)).data.data.user;return v.dispatch(u(c)),N("/home")}catch(l){alert(l.response.data.message)}return null}export{H as action,z as default};
